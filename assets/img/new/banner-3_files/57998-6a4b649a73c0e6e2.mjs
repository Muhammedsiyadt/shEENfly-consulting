"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[57998],{983272:(e,t,n)=>{function i(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:()=>o});let a=new class{constructor(){i(this,"onResumeListeners",[]),i(this,"onPauseListeners",[]),i(this,"inExp",!1),i(this,"windowInFocus",!0)}setExperiment(e=!1){this.inExp=e}onSessionResume(e){return this.onResumeListeners.push(e),this}onSessionPause(e){return this.onPauseListeners.push(e),this}removeResumeListener(e){this.onResumeListeners.filter(t=>t!==e)}removePauseListener(e){this.onPauseListeners=this.onPauseListeners.filter(t=>t!==e)}getAppState(){return this.windowInFocus?0:void 0}},s=e=>{if(e.isHidden){let{reason:t}=e;a.windowInFocus=!1,a.onPauseListeners.forEach(e=>e(t))}else a.windowInFocus=!0,a.onResumeListeners.forEach(e=>e())};setTimeout(()=>{window.addEventListener("beforeunload",()=>s({isHidden:!0,reason:"beforeunload"})),window.addEventListener("focus",()=>s({isHidden:!1})),window.addEventListener("blur",()=>s({isHidden:!0,reason:"blur"})),window.addEventListener("pageshow",()=>s({isHidden:!1})),window.addEventListener("pagehide",()=>s({isHidden:!0,reason:"pagehide"})),void 0!==document.hidden?document.addEventListener("visibilitychange",()=>s(document.hidden?{isHidden:!0,reason:"visibilitychange"}:{isHidden:!1}),!1):void 0!==document.webkitHidden&&document.addEventListener("webkitvisibilitychange",()=>s(document.webkitHidden?{isHidden:!0,reason:"visibilitychange"}:{isHidden:!1}),!1)},0);let o=a},886132:(e,t,n)=>{n.d(t,{Z:()=>N,v:()=>v});var i=n(667294),a=n(297728),s=n(630118),o=n(845729),r=n(301567),l=n(248750),d=n(353168),u=n(770975),m=n(202953),c=n(950834),p=n(438973),g=n(415787);let f=(0,o.XV)("GridProfiler"),v=()=>!!window.addEventListener&&!!window.removeEventListener&&(0,r.VZ)(),h=e=>"LAYOUT"===e.status&&500||"TIMING"===e.status&&100||null,_=(e,t)=>{if(!t){let t=(0,r.LM)();if(t===e)return f("No new items, so skip the viewport-fill check."),{complete:!1,numOfItemsChecked:e};if(!(0,r.F9)())return f("Viewport may not be filled yet."),{complete:!1,numOfItemsChecked:t}}return{complete:!0}},w=(e,t)=>{let n=0,i=0,a=0,s=0,o=0;return e=e.filter(e=>"pin"===e.type),t.forEach((t,r)=>{let l;let d=t.fileName.split(".")[0];l=e[r],d!==l?.image_signature&&(l=e.find(e=>d===e?.image_signature)),void 0===l?o+=1:l.is_promoted||l.recommendation_reason?.reason==="PROMOTED_PIN"||l?.promoter?.length?a+=1:null!==l.story_pin_data_id&&void 0!==l.story_pin_data_id?n+=1:l?.videos?.video_list?i+=1:s+=1}),{storyPinCount:n,videoCount:i,adCount:a,imageCount:s,unknownCount:o}},b=(e,t)=>{let n=()=>{window.removeEventListener(e,n),t()};return window.addEventListener(e,n),()=>window.removeEventListener(e,n)};function N({isAtEndOfFeed:e,pinData:t,includeBackgroundImages:n,includeVideos:v=!1,includeSections:N,isPlaceholderGrid:y,stopwatchSetVisuallyCompleteResult:E,stopwatchContext:L,isAuth:P}){let T=(0,u.E)(),C=T?.getId(),$=T?.setVisuallyCompleteResult,I=({imageTimings:e})=>{E&&E(),$&&$({imageTimings:e})},[A,O]=(0,i.useState)({status:"DISABLED"}),R=(0,a.F)();(0,i.useEffect)(()=>{$||E?O({status:"LAYOUT",failedCount:0,numOfItemsChecked:0}):O({status:"DISABLED"})},[C,$,E]),(0,i.useEffect)(()=>{if("DISABLED"!==A.status&&(0,d.ZP)(`GridVisuallyCompleteProfiler_${A.status}`),f("new status",A),"LAYOUT"===A.status){let e=b("scroll",()=>{(0,d.ZP)("scrollDuringLayout")});return()=>{e()}}return()=>{}},[A.status]),(0,p.Z)(()=>{if(!$&&!T&&!E&&!L)return;let i="",a="",d=()=>{},u=e=>{T?T.abort(e):L?.abort()};if(T){let{getMetricId:e}=T,t=e();a=t.surface,i=(0,s.KJ)(t),d=T.addBinaryAnnotation}else a="stopwatch",i=`${a}_${L?.name}`,L?.addBinaryAnnotation&&(d=L?.addBinaryAnnotation);let p=(0,r.cQ)(n,v,N);if(y&&!p.length){f("bypassing PWT run due to skeleton pin grid");return}switch(A.status){case"LAYOUT":{let t=_(A.numOfItemsChecked,e);t.complete?O({status:"TIMING",failedCount:0,pinElements:p}):500*A.failedCount>6e4?((0,l.A9)(`images.${i}.visuallyComplete.maxLayoutAttempt`),u("visuallyComplete_layoutTimeout")):O({...A,failedCount:A.failedCount+1,numOfItemsChecked:t.numOfItemsChecked});break}case"TIMING":{let e=(0,m.Cg)(),n=A.pinElements.length,s=[],r=0,p=0,v=0,h=1/0,_=0;if(A.pinElements.forEach(({element:t,fileName:n})=>{let i=e.find(e=>e.name.endsWith(n));i?i.responseEnd?(s.push(i),(0,o.v5)(t,"green"),"search"===a&&(h=Math.min(h,i.requestStart),_=Math.max(_,i.responseEnd))):(v+=1,(0,o.v5)(t,"blue")):t instanceof HTMLImageElement&&t.complete?(p+=1,(0,o.v5)(t,"red")):(r+=1,(0,o.v5)(t,"greenyellow"))}),r||v)100*A.failedCount>6e4?((0,l.A9)(`images.${i}.visuallyComplete.maxAttempt`,{tags:{totalImageCount:n,incompleteCount:r,noTimingCount:p,noTimingResponseEndCount:v}}),u("visuallyComplete_timingTimeout")):O({...A,failedCount:A.failedCount+1});else{if(f(`All ${s.length} images are fetched`),t&&t.length){let e=w(t,A.pinElements);if(Object.entries(e).forEach(([e,t])=>{d(e,t,"I16"),(0,c.XJ)(e,t,"I16")}),(0,l.A9)(`${i}.pinTypes`,{tags:e}),"search"===a){let e=_-h;t[0].display_options?.num_columns_requested===0?(0,g.LY)("full_width_story_image_fetch_time_true",e,{sampleRate:1}):(0,g.LY)("full_width_story_image_fetch_time_false",e,{sampleRate:.05})}}if(P&&"search"===a){let{group:e}=R.checkExperiment("dweb_grid_loading_state");e&&(0,g.S0)("webapp.gridVisuallyComplete.loadingState",n,{sampleRate:1,tags:{group:e}})}I({imageTimings:s}),O({status:"DISABLED"}),(0,l.A9)(`images.${i}.visuallyComplete.complete`,{tags:{totalImageCount:n,noTimingCount:p}})}}}},h(A))}},950834:(e,t,n)=>{let i;n.d(t,{JG:()=>Z,ud:()=>W,XJ:()=>x,ZP:()=>Q,ep:()=>j,l7:()=>V,Lg:()=>G});var a=n(983272),s=n(486997),o=n(203643),r=n(710931);let l={appVersion:(0,r.Z)(),browserName:"",browserVersion:"",country:"",deviceType:"desktop",fullPath:"",getExperimentGroup:()=>null,isAppShell:!1,isAuthenticated:!1,isBot:!1,isForcedReload:!1,isModernBundleCapable:!1,isSocialBot:!1,locale:"",osName:"",serverData:null,stageName:"",unauthId:""},d=()=>{let e=l,t=window.innerHeight,n=window.innerWidth,i=Math.abs(window.innerHeight-t),a=window.innerHeight!==t,s=window.innerWidth!==n;window.removeEventListener("resize",d),("phone"!==e.deviceType||(s||!a||!(i<=150))&&(a||s))&&("desktop"!==e.deviceType||a||s)&&(Z("windowResized"),window.removeEventListener("resize",d))};var u=n(415787);let m=null;function c(e){(0,u.QX)(`perf.not_supported.${e}`,1,{sampleRate:1})}function p(){return m||(window.performance?window.PerformanceObserver?PerformanceObserver.supportedEntryTypes?PerformanceObserver.supportedEntryTypes.includes("mark")?m=["mark","measure","now","setResourceTimingBufferSize"].reduce((e,t)=>(window.performance[t]||(c(`window_performance_${t}`),e=!1),e),!0):(c("window_PerformanceObserver_supportedEntryTypes_mark"),m=!1,!1):(c("window_PerformanceObserver_supportedEntryTypes"),m=!1,!1):(c("window_PerformanceObserver"),m=!1,!1):(c("window_performance"),m=!1,!1))}var g=n(201738),f=n(845729),v=n(493651);let h=(0,f.XV)("logPerfStats"),_=({logType:e,eventName:t,value:n,tags:i,sampleRate:a,showInConsole:s})=>{let o=n||1,r=a||1,{deviceType:d,isBot:m,isSocialBot:c}=l,p=`perf.${c&&"socialBot"||m&&"bot"||"nonbot"}.${d}.${t}`,{browserName:f,browserVersion:v,isForcedReload:_,isModernBundleCapable:w}=l,b={...i||{},browserName:f,browserVersion:v?.split(".")[0]||"0",isForcedReload:_,isModernBundleCapable:w};s&&h(`${p}: ${o}`),!g.is&&("gauge"===e?(0,u.S0)(p,o,{sampleRate:g.DQ?1:r,tags:b}):"timing"===e?o<1e5&&(0,u.LY)(p,o,{sampleRate:g.DQ?1:r,tags:b}):"count"===e&&(0,u.QX)(p,o,{sampleRate:g.DQ?1:r,tags:b}))},w=({eventName:e,value:t,tags:n,sampleRate:i,showInConsole:a})=>{_({logType:"count",eventName:e,value:t,tags:n,sampleRate:i,showInConsole:a=a||g.DQ})},b=({eventName:e,value:t,tags:n,sampleRate:i,showInConsole:a})=>{_({logType:"timing",eventName:e,value:t,tags:n,sampleRate:i,showInConsole:a=a||g.DQ})},N=(e,t)=>{let n="TIMING_ERROR";w({eventName:`${n}.${e}`,tags:{handler:(0,v.H)()}}),t&&w({eventName:`${n}.${t}.${e}`})},y=(e,t)=>{let n="TIMING_ABORT";w({eventName:`${n}.${e}`,tags:{handler:(0,v.H)()}}),t&&w({eventName:`${n}.${t}.${e}`})},E=e=>{let t="TIMING_START";w({eventName:t,tags:{handler:(0,v.H)()}}),e&&w({eventName:`${t}.${e}`})},L=e=>{let t="TIMING_COMPLETE";w({eventName:t,tags:{handler:(0,v.H)()}}),e&&w({eventName:`${t}.${e}`})},P=(e="missing_constraint_name",t)=>{let n="CONSTRAINT_COMPLETE";w({eventName:`${n}.${e}`,tags:{handler:(0,v.H)()}}),t&&w({eventName:`${n}.${t}.${e}`})},T=(e,t)=>{let n="CONSTRAINT_ABORT";w({eventName:`${n}.${e}`,tags:{handler:(0,v.H)()}}),t&&w({eventName:`${n}.${t}.${e}`})},C=(e,t)=>{let n="CONSTRAINT_START";w({eventName:`${n}.${e}`,tags:{handler:(0,v.H)()}}),t&&w({eventName:`${n}.${t}.${e}`})},$=[{handler:"www/pin/[id].js",config:{mWeb:{unauth:{initialPageLoad:{name:"pin_page_interactive",constraints:["NavigationCompletev4","PinPageMainImageRendered"]}},auth:{initialPageLoad:{name:"pin_page_interactive",constraints:["NavigationCompletev4","PinPageMainImageRendered"]},clientNavigation:{name:"pin_closeup_details",constraints:["NavigationCompletev4","PinPageMainImageRendered"]}}},dWeb:{unauth:{initialPageLoad:{name:"pin_page_interactive",constraints:["NavigationCompletev4","PinPageMainImageRendered"]}},auth:{initialPageLoad:{name:"pin_page_interactive",constraints:["NavigationCompletev4","image","resource","button"]},clientNavigation:{name:"pin_closeup_details",constraints:["NavigationCompletev4","button","video","description","shopButton","thumbnailsLoaded","image","resource"]}}}},segments:["story_pin","product_detail_page","product_detail_page_plus"]},{handler:"www/index.js",config:{unified:{auth:{initialPageLoad:{name:"home_feed_pinteractive",constraints:["NavigationCompletev4","VisuallyComplete"]},clientNavigation:{name:"home_feed_render",constraints:["NavigationCompletev4","VisuallyComplete"]}}}}},{handler:"www/search/[scope].js",config:{unified:{auth:{clientNavigation:{name:"search_feed_render",constraints:["NavigationCompletev4","VisuallyComplete"]}}}}},{handler:"www/[username]/[slug].js",config:{unified:{unauth:{initialPageLoad:{name:"board_page_interactive",constraints:["NavigationCompletev4","VisuallyComplete"]}}},dWeb:{auth:{clientNavigation:{name:"client_route_push_auth_board",constraints:["NavigationCompletev4","VisuallyComplete"]}}}}}],I=[],A={},O=[],R={},S={},H=!0,D=0,B=0,M=0;function k(){I=[],O=[],A={},i=null,B=0,M=0,R={},S={}}function V(e){if(p()){if(i){let t=I.indexOf(e);if(t>-1){if(I.splice(t,1),h(`${I.length} remaining constraints`),0===I.length){let e=B-M;L(i.name),b({eventName:i.name,value:e}),b({eventName:"complete",value:e,tags:{handler:(0,v.H)()}}),k()}}else N("constraint_completed_not_in_PWT_constraint_list")}else N("remove_constraint_while_no_PWT_in_progress"),O.push(e)}}function W(e,t){p()&&(R[e]||(R={...R,[e]:t||performance.now()}))}function x(e,t,n){p()&&(S[e]||(S={...S,[e]:{value:t,type:n}}))}function Z(e){p()&&i&&(y(e,i.name),I.forEach(e=>{T(e,i?.name)}),k())}function G(e){p()&&(i?(y("segmentChange",i.name),i.name=e,E(i.name),h("updating PWT name to the following segment:",e)):N("set_segment_while_no_PWT_in_progress"))}function j(e,t){if(p()){if(D+=1,i&&Z("routeChange"),"POP"===e&&!1===H);else{let{isAuthenticated:e,deviceType:n}=l;(i=function({isAuthenticated:e,isInitialPageLoad:t,isMobile:n}){let i=(0,v.H)(),a=$.find(e=>i===e.handler),s=a?.config,o=s?.unified;if(o||(o=n?s?.mWeb:s?.dWeb),o){let n=e?o.auth:o.unauth;if(n){if(t&&n.initialPageLoad)return h("found isInitialPageLoad config"),h(n.initialPageLoad),n.initialPageLoad;if(!t&&n.clientNavigation)return h("found clientNavigation config"),h(n.clientNavigation),n.clientNavigation}}return h("no config found :("),null}({isAuthenticated:e,isInitialPageLoad:H,isMobile:"phone"===n}))?(M=t,E(i.name),i?.constraints.forEach(e=>{!function(e){if(p()){if(i){C(e,i.name);let t=O.indexOf(e);t>-1?O.splice(t,1):I.includes(e)||I.push(e)}else N("add_constraint_while_no_PWT_in_progress")}}(e)}),h(`${I.length} remaining constraints`)):h("No PWT config found for this route"),1===D&&(H=!1)}}}function Q({requestContext:e,traceLoggerData:t,isForcedReload:n}){if(!p())return;a.Z.onSessionPause(Z),window.addEventListener("resize",d),function({requestContext:e,traceLoggerData:t,isForcedReload:n}){l={appVersion:(0,r.Z)(),browserName:e.userAgent.browserName,browserVersion:e.userAgent.browserVersion,country:e.country,deviceType:(0,s.Z)(e),fullPath:e.fullPath,getExperimentGroup:t=>e.experimentsClient.checkExperiment(t,{dangerouslySkipActivation:!0}).group||null,isAppShell:!1,isAuthenticated:e.isAuthenticated,isBot:e.isBot,isForcedReload:n,isModernBundleCapable:(0,o.Z)({browserName:e.userAgent.browserName,browserType:e.userAgent.browserType,browserVersion:e.userAgent.browserVersion,userAgentString:e.userAgent.raw}),isSocialBot:e.isSocialBot,locale:e.locale,osName:e.userAgent.osName||"",serverData:t,stageName:e.stage,unauthId:e.unauthId}}({requestContext:e,traceLoggerData:t,isForcedReload:n});let u=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{if(!e.name.startsWith("--")&&e.name.includes("constraint")){var t;!function(e,t){let n=I.indexOf(e);n>-1&&(B<t&&(B=t),A[e]=t,P(I[n],i?.name),b({eventName:`${i?.name}.constraint.${e}`,value:t}),b({eventName:`constraint.${e}`,value:t,tags:{handler:(0,v.H)()}}),V(e))}((t=e.name).includes("constraint_")?t.split("_")[1]||"":t,e.startTime)}})});u.observe({type:"mark",buffered:!0}),window.addEventListener("beforeunload",()=>{u.disconnect()})}},438973:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(667294);let a=(e,t)=>{let n=(0,i.useRef)(()=>{});(0,i.useEffect)(()=>{n.current=e},[e]),(0,i.useEffect)(()=>{if(null===t)return()=>{};let e=setInterval(()=>n.current(),t);return()=>clearInterval(e)},[t])}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/57998-6a4b649a73c0e6e2.mjs.map